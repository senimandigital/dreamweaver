<!-- auto-generated=true -->
<!DOCTYPE HTML SYSTEM "-//Macromedia//DWExtension layout-engine 5.0//dialog">
<HTML>
<HEAD>
<TITLE>Dropdown Recursive</TITLE>

<SCRIPT SRC="../../../Shared/Common/Scripts/dwscripts.js"></SCRIPT>
<SCRIPT SRC="../../../Shared/Common/Scripts/dwscriptsServer.js"></SCRIPT>
<SCRIPT SRC="../../../Shared/Common/Scripts/dwscriptsExtData.js"></SCRIPT>
<SCRIPT SRC="../../../Shared/Common/Scripts/ServerBehaviorClass.js"></SCRIPT>

<SCRIPT SRC="../../../Shared/Controls/Scripts/ConnectionMenu.js"></SCRIPT>
<SCRIPT SRC="../../../Shared/Common/Scripts/ListControlClass.js"></SCRIPT>
<SCRIPT SRC="../../../Shared/Controls/Scripts/ConnectionTableMasterMenu.js"></SCRIPT>
<SCRIPT SRC="../../../Shared/Controls/Scripts/ConnectionColumnMasterMenu.js"></SCRIPT>
<SCRIPT>

var _ConnectionName = new ConnectionMenu("Dropdown Recursive.htm", "ConnectionName", "");
var _TableName = new ConnectionTableMasterMenu("Dropdown Recursive.htm", "TableName", "");
var _FieldId = new ConnectionColumnMasterMenu("Dropdown Recursive.htm", "FieldId", "");
var _FieldUplineId = new ConnectionColumnMasterMenu("Dropdown Recursive.htm", "FieldUplineId", "");
var _MasterFieldJudul = new ConnectionColumnMasterMenu("Dropdown Recursive.htm", "MasterFieldJudul", "");
var _Master__Field__Deskripsi = new ConnectionColumnMasterMenu("Dropdown Recursive.htm", "Master__Field__Deskripsi", "");


//--------------------------------------------------------------------
// FUNCTION:
//   initializeUI
//
// DESCRIPTION:
//   Prepare the dialog and controls for user input
//
// ARGUMENTS:
//   none
//
// RETURNS:
//   nothing
//--------------------------------------------------------------------
function initializeUI()
{
  var elts;

  _ConnectionName.initializeUI();
  _TableName.initializeUI();
  _FieldId.initializeUI();
  _FieldUplineId.initializeUI();
  _MasterFieldJudul.initializeUI();
  _Master__Field__Deskripsi.initializeUI();

  elts = document.forms[0].elements;
  if (elts && elts.length)
    elts[0].focus();
}


//--------------------------------------------------------------------
// FUNCTION:
//   findServerBehaviors
//
// DESCRIPTION:
//   Returns an array of ServerBehavior objects, each one representing
//   an instance of this Server Behavior on the page
//
// ARGUMENTS:
//   none
//
// RETURNS:
//   JavaScript Array of ServerBehavior objects
//--------------------------------------------------------------------
function findServerBehaviors()
{
  _ConnectionName.findServerBehaviors();
  _TableName.findServerBehaviors();
  _FieldId.findServerBehaviors();
  _FieldUplineId.findServerBehaviors();
  _MasterFieldJudul.findServerBehaviors();
  _Master__Field__Deskripsi.findServerBehaviors();

  sbArray = dwscripts.findSBs();

  return sbArray;
}


//--------------------------------------------------------------------
// FUNCTION:
//   canApplyServerBehavior
//
// DESCRIPTION:
//   Returns true if a Server Behavior can be applied to the current
//   document
//
// ARGUMENTS:
//   sbObj - ServerBehavior object - one of the objects returned
//           from findServerBehaviors
//
// RETURNS:
//   boolean - true if the behavior can be applied, false otherwise
//--------------------------------------------------------------------
function canApplyServerBehavior(sbObj)
{
  var success = true;
  if (success)
  {
    success = _ConnectionName.canApplyServerBehavior(sbObj);
  }
  if (success)
  {
    success = _TableName.canApplyServerBehavior(sbObj);
  }
  if (success)
  {
    success = _FieldId.canApplyServerBehavior(sbObj);
  }
  if (success)
  {
    success = _FieldUplineId.canApplyServerBehavior(sbObj);
  }
  if (success)
  {
    success = _MasterFieldJudul.canApplyServerBehavior(sbObj);
  }
  if (success)
  {
    success = _Master__Field__Deskripsi.canApplyServerBehavior(sbObj);
  }
  if (success)
  {
    success = dwscripts.canApplySB(sbObj, false); // preventNesting is false
  }
  return success;
}


//--------------------------------------------------------------------
// FUNCTION:
//   applyServerBehavior
//
// DESCRIPTION:
//   Collects values from the form elements in the dialog box and
//   adds the Server Behavior to the user's document
//
// ARGUMENTS:
//   sbObj - ServerBehavior object - one of the objects returned
//           from findServerBehaviors
//
// RETURNS:
//   string - empty upon success, or an error message
//--------------------------------------------------------------------
function applyServerBehavior(sbObj)
{
  var paramObj = new Object();
  var errStr = "";

  if (!errStr)
  {
    errStr = _ConnectionName.applyServerBehavior(sbObj, paramObj);
  }
  if (!errStr)
  {
    errStr = _TableName.applyServerBehavior(sbObj, paramObj);
  }
  if (!errStr)
  {
    errStr = _FieldId.applyServerBehavior(sbObj, paramObj);
  }
  if (!errStr)
  {
    errStr = _FieldUplineId.applyServerBehavior(sbObj, paramObj);
  }
  if (!errStr)
  {
    errStr = _MasterFieldJudul.applyServerBehavior(sbObj, paramObj);
  }
  if (!errStr)
  {
    errStr = _Master__Field__Deskripsi.applyServerBehavior(sbObj, paramObj);
  }

  if (!errStr)
  {
    dwscripts.fixUpSelection(dw.getDocumentDOM(), true, true);
    dwscripts.applySB(paramObj, sbObj);
  }
  return errStr;
}


//--------------------------------------------------------------------
// FUNCTION:
//   inspectServerBehavior
//
// DESCRIPTION:
//   Sets the values of the form elements in the dialog box based
//   on the given ServerBehavior object
//
// ARGUMENTS:
//   sbObj - ServerBehavior object - one of the objects returned
//           from findServerBehaviors
//
// RETURNS:
//   nothing
//--------------------------------------------------------------------
function inspectServerBehavior(sbObj)
{
  _ConnectionName.inspectServerBehavior(sbObj);
  _TableName.inspectServerBehavior(sbObj);
  _FieldId.inspectServerBehavior(sbObj);
  _FieldUplineId.inspectServerBehavior(sbObj);
  _MasterFieldJudul.inspectServerBehavior(sbObj);
  _Master__Field__Deskripsi.inspectServerBehavior(sbObj);
}


//--------------------------------------------------------------------
// FUNCTION:
//   deleteServerBehavior
//
// DESCRIPTION:
//   Remove the specified Server Behavior from the user's document
//
// ARGUMENTS:
//   sbObj - ServerBehavior object - one of the objects returned
//           from findServerBehaviors
//
// RETURNS:
//   nothing
//--------------------------------------------------------------------
function deleteServerBehavior(sbObj)
{
  _ConnectionName.deleteServerBehavior(sbObj);
  _TableName.deleteServerBehavior(sbObj);
  _FieldId.deleteServerBehavior(sbObj);
  _FieldUplineId.deleteServerBehavior(sbObj);
  _MasterFieldJudul.deleteServerBehavior(sbObj);
  _Master__Field__Deskripsi.deleteServerBehavior(sbObj);

  dwscripts.deleteSB(sbObj);
}


//--------------------------------------------------------------------
// FUNCTION:
//   analyzeServerBehavior
//
// DESCRIPTION:
//   Performs extra checks needed to determine if the Server Behavior
//   is complete
//
// ARGUMENTS:
//   sbObj - ServerBehavior object - one of the objects returned
//           from findServerBehaviors
//   allRecs - JavaScripts Array of ServerBehavior objects - all of the
//             ServerBehavior objects known to Dreamweaver
//
// RETURNS:
//   nothing
//--------------------------------------------------------------------
function analyzeServerBehavior(sbObj, allRecs)
{
  _ConnectionName.analyzeServerBehavior(sbObj, allRecs);
  _TableName.analyzeServerBehavior(sbObj, allRecs);
  _FieldId.analyzeServerBehavior(sbObj, allRecs);
  _FieldUplineId.analyzeServerBehavior(sbObj, allRecs);
  _MasterFieldJudul.analyzeServerBehavior(sbObj, allRecs);
  _Master__Field__Deskripsi.analyzeServerBehavior(sbObj, allRecs);
}


//--------------------------------------------------------------------
// FUNCTION:
//   updateUI
//
// DESCRIPTION:
//   Called from controls to update the dialog based on user input
//
// ARGUMENTS:
//   controlName - string - the name of the control which called us
//   event - string - the name of the event which triggered this call
//           or null
//
// RETURNS:
//   nothing
//--------------------------------------------------------------------
function updateUI(controlName, event)
{
  if (window["_" + controlName] != null)
  {
    var controlObj = window["_" + controlName];

    if (_ConnectionName.updateUI != null)
    {
      _ConnectionName.updateUI(controlObj, event);
    }
    if (_TableName.updateUI != null)
    {
      _TableName.updateUI(controlObj, event);
    }
    if (_FieldId.updateUI != null)
    {
      _FieldId.updateUI(controlObj, event);
    }
    if (_FieldUplineId.updateUI != null)
    {
      _FieldUplineId.updateUI(controlObj, event);
    }
    if (_MasterFieldJudul.updateUI != null)
    {
      _MasterFieldJudul.updateUI(controlObj, event);
    }
    if (_Master__Field__Deskripsi.updateUI != null)
    {
      _Master__Field__Deskripsi.updateUI(controlObj, event);
    }
  }
}

</SCRIPT>
<script>
function commandButtons(){
  return new Array("OK",           "applyServerBehavior(); window.close()",
                   "Keluar",       "window.close()",
                   "",             "",
                   "Edit",         "dreamweaver.browseDocument('http://dreamweaver.phpmysource.kom/ServerBehaviors.php?configuration='+ dreamweaver.getConfigurationPath() + '&ServerModel=' +dwscripts.getServerModel()+ '&getSBFileName='+ dwscripts.getSBFileName() +'&Title=Dropdown Recursive' )",
                   "Bantuan",      "dwscripts.callCommand('senimandigital - serverbehavior - bantuan', 'Dropdown Recursive')",
                   "Komunitas",    "dreamweaver.browseDocument('http://dreamweaver.senimandigital.com/redirect.php?configuration='+ dreamweaver.getConfigurationPath() + '&ServerBehaviors&ServerModel='+ dwscripts.getServerModel() +'&Title=Dropdown Recursive' )"
);
}
// dwscripts.getSBFileName(); mendapatkan nama File Server Behaviors
</script>
</HEAD>

<BODY onLoad="initializeUI()">
<FORM NAME="theForm">
<TABLE BORDER=0>
    <TR>
      <TD ALIGN="right" NOWRAP>ConnectionName:</TD>
      <TD VALIGN="baseline" NOWRAP>
        <SELECT STYLE="width:150px" NAME="ConnectionName" onChange="updateUI('ConnectionName','onChange')">
        </SELECT><INPUT TYPE="button" VALUE="Define..." onClick= "_ConnectionName.launchConnectionDialog()" >
      </TD>
    </TR>
    <TR><TD HEIGHT="1"></TD></TR>
    <TR>
      <TD ALIGN="right" NOWRAP>TableName:</TD>
      <TD VALIGN="baseline" NOWRAP>
        <SELECT STYLE="width:250px" NAME="TableName" onChange="updateUI('TableName','onChange')">
          <OPTION SELECTED>*** No Table Found</OPTION>
        </SELECT>
      </TD>
    </TR>
    <TR><TD HEIGHT="1"></TD></TR>
    <TR>
      <TD ALIGN="right" NOWRAP>FieldId:</TD>
      <TD VALIGN="baseline" NOWRAP>
        <SELECT STYLE="width:250px" NAME="FieldId">
          <OPTION SELECTED>*** No Column Found</OPTION>
        </SELECT>
      </TD>
    </TR>
    <TR><TD HEIGHT="1"></TD></TR>
    <TR>
      <TD ALIGN="right" NOWRAP>FieldUplineId:</TD>
      <TD VALIGN="baseline" NOWRAP>
        <SELECT STYLE="width:250px" NAME="FieldUplineId">
          <OPTION SELECTED>*** No Column Found</OPTION>
        </SELECT>
      </TD>
    </TR>
    <TR><TD HEIGHT="1"></TD></TR>
    <TR>
      <TD ALIGN="right" NOWRAP>MasterFieldJudul:</TD>
      <TD VALIGN="baseline" NOWRAP>
        <SELECT STYLE="width:250px" NAME="MasterFieldJudul">
          <OPTION SELECTED>*** No Column Found</OPTION>
        </SELECT>
      </TD>
    </TR>
    <TR><TD HEIGHT="1"></TD></TR>
    <TR>
      <TD ALIGN="right" NOWRAP>Master Field Deskripsi:</TD>
      <TD VALIGN="baseline" NOWRAP>
        <SELECT STYLE="width:250px" NAME="Master__Field__Deskripsi">
          <OPTION SELECTED>*** No Column Found</OPTION>
        </SELECT>
      </TD>
    </TR>
    <TR><TD HEIGHT="1"></TD></TR>
  </TABLE>
</FORM>
</BODY>
</HTML>

